# 출석 관리 시스템 - Python GUI 버전

PyQt5 기반 데스크톱 애플리케이션

## 📋 주요 기능

- ✅ **시작일 자유 선택** - 원하는 날짜부터 1개월 단위로 관리
- ✅ **월별 출석률 저장** - 매월 출석률을 기록하고 이력 관리
- ✅ **캘린더 기반 직관적인 UI** - 클릭으로 간편하게 출결 상태 변경
- ✅ **6가지 출결 상태** - 출석/결석/지각/조퇴/외출/병결
- ✅ **실시간 출석률 계산** - 데이터 변경 시 즉시 반영
- ✅ **복잡한 패널티 규칙 적용**
  - 동일 사유 2회 = 결석 1회
  - 상이 사유 3회 = 결석 1회
- ✅ **목표 출석률 설정** - 100%, 95%, 90%, 85%, 80%, 75%
- ✅ **통계 대시보드** - 각 상태별 횟수를 한눈에 확인
- ✅ **스크롤 지원** - 내용이 많아도 모두 확인 가능
- ✅ **EXE 파일 배포** - Python 없이도 실행 가능

## 🚀 설치 및 실행

### 방법 1: Python 스크립트로 실행

1. **필요한 패키지 설치:**
   ```bash
   pip install -r requirements.txt
   ```

2. **앱 실행:**
   ```bash
   python attendance_app.py
   ```

### 방법 2: EXE 파일로 빌드

1. **EXE 빌드:**
   ```bash
   # Windows
   build_exe.bat
   ```

2. **생성된 EXE 실행:**
   ```
   dist\출석관리시스템.exe
   ```

## 💡 사용 방법

### 1. 기본 설정

**출석 시작일 선택**
- 상단의 "📅 출석 시작일" 드롭다운 클릭
- 원하는 시작 날짜 선택
- 자동으로 1개월 단위기간 설정 (예: 10월 26일 ~ 11월 26일)

**목표 출석률 설정**
- 우측 상단 "목표" 드롭다운에서 선택
- 달성 여부에 따라 출석률 색상 변경
  - 초록색: 90% 이상
  - 주황색: 80~89%
  - 빨간색: 80% 미만

### 2. 출결 상태 변경

1. 캘린더에서 평일 날짜 클릭
2. 팝업 창에서 상태 선택
   - 🟢 출석
   - 🔴 결석
   - 🟠 지각
   - 🟡 조퇴
   - 🟣 외출
   - ⚪ 병결
3. "확인" 버튼 클릭
4. 출석률 자동 재계산 및 통계 업데이트

### 3. 월별 출석률 기록

1. 한 달이 끝나면 "💾 현재 달 저장" 버튼 클릭
2. 월별 출석률 요약에 기록됨
3. 과거 월별 출석률 이력 확인 가능
4. 각 월의 출석률, 평일 수, 결석/지각/조퇴 횟수 표시

### 4. 출석률 확인

**현재 출석률**
- 상단 대시보드에 큰 숫자로 표시
- 색상으로 달성도 확인

**출결 현황**
- 각 상태별 횟수를 카드 형태로 표시
- 비비드한 색상으로 가독성 향상

**월별 요약**
- 저장된 과거 월별 출석률 확인
- 월별 비교 및 추세 파악

## 📊 출석률 계산 규칙

### 기본 규칙
- **총 수업일수**: 평일(월~금)만 카운트
- **병결**: 출석으로 인정 (감점 없음)
- **단위기간**: 시작일부터 정확히 1개월

### 패널티 규칙

**1. 동일 사유 중복 (Same Type Pair)**
- 지각 2회 = 결석 1회
- 조퇴 2회 = 결석 1회
- 외출 2회 = 결석 1회

**2. 상이 사유 중복 (Mixed Type Triple)**
- 규칙 1 적용 후 남은 횟수의 합
- (지각 나머지 + 조퇴 나머지 + 외출 나머지) 3회 = 결석 1회

### 계산 공식
```
최종 결석 수 = 직접 결석 + (규칙1 환산 결석) + (규칙2 환산 결석)
출석률(%) = ((총 수업일수 - 최종 결석 수) / 총 수업일수) × 100
```

### 예시
```
평일 수: 22일
출석 데이터:
- 결석: 1회
- 지각: 3회
- 조퇴: 2회
- 외출: 1회

계산:
1. 동일 사유: 지각 3회 → 1회(결석) + 1회(나머지)
2. 동일 사유: 조퇴 2회 → 1회(결석)
3. 상이 사유: (지각 나머지 1회 + 외출 1회) = 2회 → 0회(결석)
4. 최종 결석: 1 + 1 + 1 = 3회
5. 출석률: (22 - 3) / 22 × 100 = 86.4%
```

## 🎨 UI 특징

### 창 크기
- **고정 크기**: 1500 x 800 픽셀
- **스크롤 지원**: 내용이 많을 때 세로 스크롤 자동 표시

### 색상 시스템
- **출석**: 초록색 (#10b981)
- **결석**: 빨간색 (#ef4444)
- **지각**: 주황색 (#f97316)
- **조퇴**: 노란색 (#eab308)
- **외출**: 연보라색 (#a78bfa)
- **병결**: 회색 (#6b7280)

### 디자인 요소
- **모던한 카드 레이아웃**: 깔끔한 그룹박스와 카드 디자인
- **비비드 색상**: 통계 카드에 선명한 색상 적용
- **캘린더 하이라이트**: 날짜별 상태가 색상으로 표시
- **반응형 레이아웃**: 스크롤로 모든 내용 접근 가능
- **커스텀 스크롤바**: 얇고 세련된 디자인

## 📦 파일 구조

```
attendance-rate/
├── attendance_app.py      # 메인 애플리케이션
├── requirements.txt        # 필요한 패키지 목록
├── build_exe.bat          # EXE 빌드 스크립트 (Windows)
├── README_GUI.md          # 이 파일
├── index.html             # 웹 버전 (레거시)
└── dist/                  # 빌드된 EXE 파일 (빌드 후 생성)
    └── 출석관리시스템.exe
```

## 🔧 개발 환경

- **Python**: 3.8 이상
- **PyQt5**: 5.15.10
- **PyInstaller**: 6.3.0
- **OS**: Windows 10/11 (권장)

## 🎯 주요 업데이트 내역

### v2.0 (최신)
- ✅ 월별 출석률 저장 및 이력 관리 기능
- ✅ 시작일 자유 선택 기능 (QDateEdit)
- ✅ 세로 스크롤 지원
- ✅ 창 크기 최적화 (1500x800)
- ✅ 통계 카드 색상 개선
- ✅ ISO 주차 번호 제거
- ✅ 과거 데이터 누적 관리

### v1.0
- ✅ 기본 출석 관리 기능
- ✅ 캘린더 UI
- ✅ 패널티 규칙 적용
- ✅ EXE 빌드 지원

## 💻 시스템 요구사항

- **OS**: Windows 10/11 (권장), macOS, Linux
- **RAM**: 최소 2GB
- **저장공간**: 150MB 이상
- **Python**: 3.8 이상 (스크립트 실행 시)
- **화면 해상도**: 1920x1080 이상 권장

## 🐛 문제 해결

### "ModuleNotFoundError: No module named 'PyQt5'"
```bash
pip install PyQt5
```

### EXE 빌드 시 에러
```bash
pip install --upgrade pyinstaller
pip uninstall pyinstaller
pip install pyinstaller==6.3.0
```

### 한글 폰트가 깨짐
- Windows: 자동으로 "맑은 고딕" 사용
- macOS/Linux: 시스템 기본 한글 폰트 사용
- 폰트가 없으면 수동 설치 필요

### 창이 너무 작거나 큼
- 창 크기는 1500x800으로 고정
- 스크롤을 사용하여 모든 내용 확인
- 모니터 해상도 1920x1080 이상 권장

## 📝 데이터 관리

### 현재 상태
- 앱 종료 시 데이터가 저장되지 않음
- 매번 실행 시 초기화됨
- 월별 저장 기록도 휘발성

### 향후 개선 예정
- JSON 파일로 자동 저장/불러오기
- SQLite 데이터베이스 지원
- 백업/복원 기능

## 🎯 향후 개발 계획

### 진행 예정
- [ ] 데이터 영구 저장 (JSON, SQLite)
- [ ] 엑셀 내보내기 (xlsx)
- [ ] 여러 학기/연도 관리
- [ ] 통계 차트 추가 (matplotlib)
- [ ] 인쇄 기능
- [ ] 다크 모드
- [ ] 설정 메뉴
- [ ] 데이터 백업/복원

### 검토 중
- [ ] 클라우드 동기화
- [ ] 모바일 앱 연동
- [ ] 다국어 지원
- [ ] 테마 커스터마이징

## 📞 문의 및 기여

이슈가 있으면 GitHub Issues에 등록해주세요.

## 📝 라이선스

MIT License

---

**개발**: 2025년
**버전**: 2.0
**플랫폼**: PyQt5
